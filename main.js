(()=>{"use strict";async function e(e){const t=`https://api.openweathermap.org/data/2.5/weather?units=metric&q=${e}&appid=458b6f24d9bec1db57c2f337dc35dbcc`,n=await fetch(t);return await n.json()}function t(e){const t=document.querySelector(".history"),n=t.querySelectorAll("p");if(Array.from(n).map((e=>e.innerText)).includes(e))return;const a=document.createElement("p");a.innerText=e,t.insertBefore(a,n[0]),n.length>=10&&n[n.length-1].remove()}async function n(e){const n=document.querySelector(".weather");n.innerHTML="";const a=document.querySelector(".map");a.innerHTML="";const r=document.createElement("p");if(void 0===e.name)return r.innerText="Can't find this city, try again.",void n.appendChild(r);r.innerText=`Showing weather for ${e.name}`,n.appendChild(r);const c=document.createElement("p");c.innerText=`Current weather is ${e.main.temp} degrees of Celcium`,n.appendChild(c);const i=document.createElement("img"),o=e.weather[0].icon;i.src=`https://openweathermap.org/img/wn/${o}@2x.png`,n.appendChild(i);const s=document.createElement("img");s.src=`https://static-maps.yandex.ru/1.x/?ll=${e.coord.lon},${e.coord.lat}&size=450,450&z=11&l=map`,a.appendChild(s),t(e.name);let d=JSON.parse(localStorage.getItem("history"));-1==d?.indexOf(e.name)&&d.push(e.name),localStorage.setItem("history",JSON.stringify(d))}async function a(e){const t=await fetch(e);return await t.json()}async function r(t){const a=t.target;if("P"!=a.tagName)return;const r=await e(a.innerText);await n(r)}!async function(){!function(){let e=localStorage.getItem("history");e?JSON.parse(e).forEach((e=>{t(e)})):(e=[],localStorage.setItem("history",JSON.stringify(e)))}(),document.querySelector(".history").addEventListener("click",r);const c=await async function(){const e=await a("https://get.geojs.io/v1/ip/geo.json"),t=e.latitude,n=e.longitude;return await a(`https://api.openweathermap.org/data/2.5/weather?units=metric&lat=${t}&lon=${n}&appid=458b6f24d9bec1db57c2f337dc35dbcc`)}();await n(c),document.querySelector("#submit").addEventListener("click",(async()=>{const t=document.querySelector(".city");if(""==t.value)return;const a=await e(t.value);await n(a),t.value=""}))}()})();